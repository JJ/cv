name: "Check and test package"

on:
  push:
    paths:
      - '*.Rmd'
      - .github/workflows/R-stuff.yml
      
jobs:
  run-checks:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - uses: r-lib/actions/setup-r@v2
      - uses: r-lib/actions/setup-pandoc@v2
      - uses: r-lib/actions/setup-r-dependencies@v2
        with:
          cache-version: 2
      - name: Install latex
        run: sudo apt-get install -y texlive-latex-base
      - name: Generate file
        run: bin/rmd-render.R academic-cv-summary.Rmd
      - name: Publishes CV
        uses: ncipollo/release-action@v1
        with:
          artifacts: "academic-cv-summary.pdf"
          body: Fresh CV generated
          token: ${{ secrets.GITHUB_TOKEN }}
